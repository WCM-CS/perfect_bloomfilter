#!/bin/bash

INNER_LINES=()
OUTER_LINES=()

for file in ./data/pbf_data/*; do
  if [[ -f "$file" ]]; then
    filename=$(basename "$file")
    lines=$(wc -l < "$file")
    if [[ "$filename" == inner* ]]; then
      INNER_LINES+=("$lines")
    elif [[ "$filename" == outer* ]]; then
      OUTER_LINES+=("$lines")
    fi
  fi
done

# Function to compute min, max, avg
stats() {
  arr=("$@")
  min=${arr[0]}
  max=${arr[0]}
  sum=0
  for n in "${arr[@]}"; do
    (( n < min )) && min=$n
    (( n > max )) && max=$n
    sum=$((sum + n))
  done
  len=${#arr[@]}
  avg=$(echo "scale=2; $sum / $len" | bc)
  echo "count=$len min=$min max=$max avg=$avg"
}

echo "Inner files: $(stats "${INNER_LINES[@]}")"
echo "Outer files: $(stats "${OUTER_LINES[@]}")"
